<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ğŸ“§ í…œí”Œë¦¿ ê´€ë¦¬</title>
    <style>
        body { font-family: "Malgun Gothic", sans-serif; padding: 20px; background-color: #f6f7fb; }
        .manager-container { background: #fff; padding: 20px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h2 { margin-top: 0; }
        .template-item { border: 1px solid #ddd; padding: 15px; margin-bottom: 10px; border-radius: 5px; background-color: #fff; }
        .template-item label { font-weight: bold; display: block; margin-top: 8px; }
        .template-item input, .template-item textarea { width: 100%; padding: 8px; margin-top: 4px; box-sizing: border-box; }
        .template-item textarea { height: 100px; resize: vertical; }
        .action-buttons { margin-top: 10px; text-align: right; }
        .action-buttons button { padding: 8px 15px; margin-left: 5px; cursor: pointer; border: none; border-radius: 5px; }
        .save { background-color: #007bff; color: white; }
        .delete { background-color: #dc3545; color: white; }
        .add-new { width: 100%; padding: 10px; background-color: #28a745; color: white; border: none; border-radius: 5px; margin-top: 20px; cursor: pointer; }
        .info-box { background-color: #ffc; border: 1px solid #ff0; padding: 10px; margin-bottom: 20px; border-radius: 5px; }
    </style>
</head>
<body>
    <div class="manager-container">
        <h2>í…œí”Œë¦¿ ê´€ë¦¬</h2>
        <div class="info-box">
            ë©”ì¼ ë¬¸ì•ˆì—ëŠ” **{n}** (ë°›ëŠ” ë¶„ ì„±í•¨), **{t}** (ì‘í’ˆëª…), **{d}** (ì»¨íŒ ìš”ì²­ì¼), **{signature}** (ìœ ì†Œì • ë“œë¦¼) ë³€ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì¤„ë°”ê¿ˆì€ Enterí‚¤ë¥¼ ì´ìš©í•´ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.
        </div>
        
        <div id="templatesList">
            </div>

        <button class="add-new" onclick="addNewTemplate()">â• ìƒˆ í…œí”Œë¦¿ ì¶”ê°€</button>
    </div>

    <script>
        const templatesList = document.getElementById('templatesList');
        const storageKey = 'emailTemplates';

        // í…œí”Œë¦¿ ê¸°ë³¸ê°’ (ë©”ì¸ ì°½ê³¼ ì¼ì¹˜í•´ì•¼ í•¨)
        const DEFAULT_TEMPLATES = {
            "sns": { name: "â‘  SNS í¬ìŠ¤íŒ… ì»¨íŒ ìš”ì²­", text: "{n}ë‹˜ ì•ˆë…•í•˜ì„¸ìš”.\\nì¹´ì¹´ì˜¤ì—”í„°í…Œì¸ë¨¼íŠ¸ ìœ ì†Œì •ì…ë‹ˆë‹¤.\\n\\nê·€ì‚¬ {t} ì‘í’ˆì˜ íƒ€íŒŒìŠ¤ SNS í¬ìŠ¤íŒ…ì„ í¬ë§í•˜ì—¬ ì—°ë½ë“œë¦½ë‹ˆë‹¤.\\nìƒì„¸ ë‚´ìš©ì€ ì•„ë˜ í‘œë¥¼ í†µí•´ í™•ì¸ ë¶€íƒë“œë¦¬ë©°,\\nê´€ë ¨í•˜ì—¬ ê¶ê¸ˆí•˜ì‹  ì‚¬í•­ì€ ì–¸ì œë“  í¸íˆ ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.\\n\\n{d}\\n\\nê°ì‚¬í•©ë‹ˆë‹¤.\\n{signature}" },
            "discount": { name: "â‘¡ í• ì¸ì´ë²¤íŠ¸ ì»¨íŒ ìš”ì²­", text: "{n}ë‹˜ ì•ˆë…•í•˜ì„¸ìš”,\\nì¹´ì¹´ì˜¤ì—”í„°í…Œì¸ë¨¼íŠ¸ ìœ ì†Œì •ì…ë‹ˆë‹¤.\\n\\níƒ€íŒŒìŠ¤ì—ì„œ ë‹¤ê°€ì˜¤ëŠ” <00ì›” ì§„í–‰ ì˜ˆì •ì¸> í• ì¸ì´ë²¤íŠ¸ì—\\nê·€ì‚¬ {t} ì‘í’ˆì˜ ì°¸ì—¬ë¥¼ ì œì•ˆë“œë¦¬ê³ ì ì—°ë½ë“œë¦½ë‹ˆë‹¤.\\nìƒì„¸ ë‚´ìš©ì€ ì•„ë˜ í‘œë¥¼ í†µí•´ í™•ì¸ ë¶€íƒë“œë¦¬ë©°,\\nê´€ë ¨í•˜ì—¬ ê¶ê¸ˆí•˜ì‹  ì‚¬í•­ì€ ì–¸ì œë“  í¸íˆ ì—°ë½ ë¶€íƒë“œë¦½ë‹ˆë‹¤.\\n\\n{d}\\n\\nê°ì‚¬í•©ë‹ˆë‹¤.\\n{signature}" },
            "viewing": { name: "â‘¢ ì—´ëŒì´ë²¤íŠ¸ ì—ì…‹ ì»¨íŒ ìš”ì²­", text: "{n}ë‹˜ ì•ˆë…•í•˜ì„¸ìš”,\\nì¹´ì¹´ì˜¤ì—”í„°í…Œì¸ë¨¼íŠ¸ ìœ ì†Œì •ì…ë‹ˆë‹¤.\\n\\nê·€ì‚¬ {t} ì‘í’ˆì˜ íƒ€íŒŒìŠ¤ ì—´ëŒì´ë²¤íŠ¸ ì§„í–‰ì„ í¬ë§í•˜ì—¬ ì—°ë½ë“œë¦½ë‹ˆë‹¤.\\nì•„ë˜ í‘œì™€ ì²¨ë¶€íŒŒì¼ì„ í†µí•´ ìƒì„¸ ë‚´ìš©ê³¼ ì´ë²¤íŠ¸ ì—ì…‹ ì „ë‹¬ë“œë¦¬ì˜¤ë‹ˆ í™•ì¸ì„ ë¶€íƒë“œë¦¬ë©°,\\nê²€í†  ê³¼ì •ì—ì„œ ë¬¸ì˜ì‚¬í•­ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  í¸íˆ ì—°ë½ ì£¼ì‹œê¸° ë°”ëë‹ˆë‹¤.\\n\\n{d}\\n\\nê°ì‚¬í•©ë‹ˆë‹¤.\\n{signature}" }
        };

        function loadTemplates() {
            let templates = JSON.parse(localStorage.getItem(storageKey));
            
            if (!templates) {
                templates = DEFAULT_TEMPLATES;
                saveTemplates(templates);
            }
            renderTemplates(templates);
        }

        function saveTemplates(templates) {
            localStorage.setItem(storageKey, JSON.stringify(templates));
            // ë©”ì¸ ì°½ì— í¬ì»¤ìŠ¤ë¥¼ ì£¼ì–´ ë³€ê²½ì‚¬í•­ ë°˜ì˜ì„ ìš”ì²­
            if (window.opener) {
                 window.opener.focus();
            }
        }

        function renderTemplates(templates) {
            templatesList.innerHTML = '';
            for (const key in templates) {
                const item = document.createElement('div');
                item.className = 'template-item';
                item.innerHTML = `
                    <label>ID (ê³ ìœ  í‚¤):</label>
                    <input type="text" value="${key}" disabled>
                    <label>í‘œì‹œ ì´ë¦„:</label>
                    <input type="text" id="name-${key}" value="${templates[key].name}">
                    <label>ë©”ì¼ ë¬¸ì•ˆ:</label>
                    <textarea id="text-${key}">${templates[key].text.replace(/\\n/g, '\n')}</textarea>
                    <div class="action-buttons">
                        <button class="save" onclick="saveTemplate('${key}')">ì €ì¥</button>
                        <button class="delete" onclick="deleteTemplate('${key}')">ì‚­ì œ</button>
                    </div>
                `;
                templatesList.appendChild(item);
            }
        }

        function saveTemplate(key) {
            const templates = JSON.parse(localStorage.getItem(storageKey));
            const newName = document.getElementById(`name-${key}`).value;
            // textareaì˜ ì‹¤ì œ ì¤„ë°”ê¿ˆì„ ì €ì¥ìš© '\\n' ë¬¸ìì—´ë¡œ ë³€í™˜
            const newText = document.getElementById(`text-${key}`).value.replace(/\n/g, '\\n'); 

            if (!newName || !newText) {
                alert("ì´ë¦„ê³¼ ë¬¸ì•ˆì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }

            templates[key] = { name: newName, text: newText };
            saveTemplates(templates);
            loadTemplates();
            alert("í…œí”Œë¦¿ì´ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤. ë©”ì¸ ì°½ì— ë°˜ì˜ë©ë‹ˆë‹¤.");
        }

        function deleteTemplate(key) {
            if (!confirm(`'${key}' í…œí”Œë¦¿ì„ ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
            
            const templates = JSON.parse(localStorage.getItem(storageKey));
            delete templates[key];
            saveTemplates(templates);
            loadTemplates();
            alert("í…œí”Œë¦¿ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤. ë©”ì¸ ì°½ì— ë°˜ì˜ë©ë‹ˆë‹¤.");
        }

        function addNewTemplate() {
            const templates = JSON.parse(localStorage.getItem(storageKey));
            let newKey = prompt("ìƒˆ í…œí”Œë¦¿ì˜ ê³ ìœ  ID (ì˜ì–´ ì†Œë¬¸ì, ìˆ«ì)ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”:").trim();
            
            if (!newKey) return;
            newKey = newKey.toLowerCase().replace(/[^a-z0-9]/g, ""); 

            if (!newKey || templates[newKey]) {
                alert("ìœ íš¨í•˜ì§€ ì•Šê±°ë‚˜ ì´ë¯¸ ì¡´ì¬í•˜ëŠ” IDì…ë‹ˆë‹¤. ë‹¤ë¥¸ IDë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }
            
            templates[newKey] = { name: "ìƒˆ í…œí”Œë¦¿ (ì´ë¦„ ë³€ê²½ í•„ìš”)", text: "{n}ë‹˜ ì•ˆë…•í•˜ì„¸ìš”.\\n[ì—¬ê¸°ì— í…œí”Œë¦¿ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”]\\n\\nê°ì‚¬í•©ë‹ˆë‹¤.\\n{signature}" };
            saveTemplates(templates);
            loadTemplates();
        }

        loadTemplates();
    </script>
</body>
</html>